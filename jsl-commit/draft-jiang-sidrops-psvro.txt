



SIDROPS                                                         S. Jiang
Internet-Draft                                   Zhongguancun Laboratory
Intended status: Informational                             19 April 2024
Expires: 21 October 2024


                Route Origin Registry Problem Statement
                    draft-jiang-sidrops-psvro-latest

Abstract

   Prefix hijacking has emerged as a major security threat in the Border
   Gateway Protocol (BGP), garnering widespread attention.  To mitigate
   such attacks, Internet Routing Registries (IRR) and Resource Public
   Key Infrastructure (RPKI) have been developed, providing reliable
   mappings of IP prefixes to authorized Autonomous Systems (ASes).
   Nonetheless, challenges persist due to outdated Route objects within
   IRR and the limited deployment rates of RPKI.  This document serves
   to outline the current state and problem statement for route origin
   registry.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 21 October 2024.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Requirements Language
   3.  Working Definition of Route Origin Registry
   4.  Problem Statement
     4.1.  Integrity and Accuracy
     4.2.  Multi-origin ASes Analysis
     4.3.  Inconsistency of Multi-source Data
     4.4.  Management and Synchronization
     4.5.  Multi-party Collaboration
     4.6.  Summary
   5.  Security Considerations
   6.  IANA Considerations
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Acknowledgments
   Author's Address

1.  Introduction

   The Border Gateway Protocol (BGP) is widely utilized for inter-domain
   routing.  However, its lack of built-in security mechanisms makes it
   vulnerable to various threats [RFC4272], such as prefix hijacking.
   To address this issue, the global Internet infrastructure needs to
   establish a database that records the mapping of IP prefixes to
   authorized origin Autonomous Systems (ASes).  This database would
   enable the verification of BGP announcements and facilitate the
   identification of unauthorized routing.

   Currently, network operators primarily rely on the Internet Routing
   Registry (IRR) and Resource Public Key Infrastructure (RPKI)
   [RFC6480] for route origin validation.  However, IRR lacks effective
   validation mechanisms and fails to incentivize resource holders to
   update objects, resulting in outdated information.  Similarly, RPKI
   faces challenges related to complex operations, misissued Route
   Origin Authorizations (ROAs), and the hierarchical dependencies of
   certificates, limiting its widespread deployment.

   This document aims to provide insights and recommendations to network
   operators, researchers, and policymakers for improving the security
   and robustness of the global routing system by analyzing the problems
   associate with route origin registry.

2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Working Definition of Route Origin Registry

   Route origin registry refers to a repository that records the mapping
   of IP prefixes to the ASNs authorised to announce it, where resource
   holders can register route origin mapping relationships themselves or
   delegate to othersy

   Route origin registry include the IRR and the RPKI.  The IRR records
   the binding relationship between IPs and ASNs via the Route(6) object
   defined by the Routing Policy Specification Language (RPSL).  The
   RPKI system is a formally verifiable database based on resource
   certificates that define extensions to X.509 to represent the IP
   prefix and ASN.

4.  Problem Statement

4.1.  Integrity and Accuracy

   As the adoption of Resource Public Key Infrastructure (RPKI)
   continues to grow, the number of address prefixes registered with
   RPKI is gradually increasing.  However, the coverage of address space
   within RPKI remains relatively low.  Relying solely on RPKI database
   for route filtering and validation is insufficient due to this
   limited address space coverage.

   Concurrently, the absence of duplicate and unauthorised checking by
   RPKI during the issuance of resource certificates has resulted in the
   inability to guarantee data accuracy within the ROA.  Furthermore,
   RPKI continues to face security risks, including those associated
   with centralised authorisation and the inconsistencies of relying
   parties.  Notably, the protection rate of route origin
   validation(ROV), as indicated by RoVista [RoVista], is significantly
   lower compared to route origin authorization(ROA) coverage.

   As mentioned in [RFC7682], the lack of certification and incentives
   for maintaining up-to-date data within Internet Routing Registry
   (IRR) database leads to lower accuracy and integrity of the
   information.  While a few databases exhibit regular updates, many
   others have low activity, with Route objects remaining unchanged for
   several years.  Recent measurement [IRRegularities] reveals that IRR
   databases with low update activity exhibit lower overlap rates in
   recent BGP announcements compared to those with higher activity.
   This indicates that databases with lower activity may contain a
   higher proportion of outdated and stale Route objects, thereby
   impacting the reliability of the route origin registry.
   Additionally, [IRRegularities] also notes a decreasing trend in
   address space coverage in certain IRR databases, emphasizing the need
   to prioritize data accuracy.

   In summary, while the adoption of RPKI is growing, the limited
   coverage of address space within RPKI and the challenges associated
   with maintaining up-to-date data in IRR databases underscore the need
   for a comprehensive and accurate approach to route filtering and
   validation.  Efforts should focus on improving the accuracy,
   integrity, and coverage of route origin registry to ensure the
   reliability and security of the global routing infrastructure.

4.2.  Multi-origin ASes Analysis

   [RFC1930] suggests that a prefix should typically have a single
   Autonomous System (AS) as its origin, with a few exceptions.
   However, analysis of routing data from Routeviews, conducted by CAIDA
   [CAIDA], reveals that Multi-origin ASes (MOAS) have become a common
   phenomenon.  This can be attributed to factors such as multi-homing,
   traffic engineering, multinational companies, as well as
   misconfigurations or prefix hijacking incidents.  When examining the
   MOAS state, it becomes evident that currently active IRR databases
   offer limited full coverage for MOAS, particularly in the case of
   IPv6 MOAS.

   Moreover, legitimate MOAS primarily arises from multinational
   companies and multi-homing scenarios.  However, the existing
   authoritative IRR (maintained by regional Internet registries) and
   RPKI databases typically only allow registration of address blocks
   for self-managed purposes.  This poses a significant obstacle in
   supporting legitimate MOAS.  On the other hand, misconfigurations
   often occur within the same Internet Service Provider (ISP) when they
   have multiple ASNs and IP prefixes.  These cases result from
   confusion during the configuration or updating of Route objects or
   Route Origin Authorization (ROA), thereby bypassing the current
   validation mechanisms.

   The prevalence of MOAS in practice highlights the need for addressing
   the challenges associated with managing and supporting MOAS
   effectively.  This includes improving the coverage of MOAS in IRR and
   RPKI databases, accommodating legitimate instances of MOAS and
   addressing misconfigurations.

4.3.  Inconsistency of Multi-source Data

   Based on the analysis presented in the previous section, it is
   evident that relying solely on a single source of route origin
   registry is insufficient and inaccuracies in route origin validation.
   To address this issue effectively, it is recommended to integrate the
   RPKI database and multiple active IRR databases.  This integration
   would not only enhance the IP address space coverage and AS
   participation rate but also improve the accuracy of route origin
   registry.

   However, it is important to note that this fusion approach may
   encounter several limitations.  As highlighted in [IRRegularities],
   inconsistencies exist among the Route objects across different IRR
   databases.  This inconsistency can be attributed to the chronic
   neglect of IRR customers.  For instance, some companies may register
   Route objects in multiple IRR databases but fail to update them in
   all the databases, resulting in outdated and stale Route objects.

   Furthermore, it is observed that a higher number of IRR databases
   exhibit lower consistency with RPKI.  Since RPKI incorporates a
   validation mechanism and each object has a validity period, IRR
   databases that are inconsistent with RPKI are more likely to contain
   stale Route objects.  In addition, some companies that facilitate ROV
   verification present discrepancies in their methodologies when ROVs
   and IRRs conflict, resulting in disparate outcomes when filtering
   routes.

   As a result, while integrating the RPKI database and multiple active
   IRR databases can improve the effectiveness of route origin
   validation, it is essential to address the issues of inconsistencies
   and outdated Route objects within the IRR databases.

4.4.  Management and Synchronization

   The current practice in IRRs involves the use of the Near-Real-Time
   Mirroring (NRTM) protocol [NRTMv4] to replicate and synchronize Route
   object from other IRRs.  Similarly, RPKIs rely on the RPKI Repository
   Delta Protocol (RRDP) [RFC8182] to synchronize and update data.
   However, these network protocols exhibit several weaknesses that need
   to be addressed.

   *  The lack of validation of replicated data from mirrored sources in
      both IRRs and RPKIs is a significant concern.  This leaves room
      for potential inconsistencies and conflicts with the existing
      data, compromising the integrity of the system.

   *  The absence of application security mechanisms within these
      protocols is another area of vulnerability.  This lack of security
      measures exposes the system to potential threats and unauthorized
      access.

   *  The absence of a mechanism to notify other mirrors when updates
      occur results in synchronization delays and data inconsistency
      issues.  This can be problematic when timeliness and accuracy are
      crucial.

   On the other hand, to address revocation and update issues by coarse-
   grained management, alternative solutions such as Minimal-ROA
   [RFC9319] have been proposed.  While Minimal-ROA enhances coding
   efficiency and scalability by minimizing the use of the maxLength
   parameter, it falls short in supporting efficient incremental
   updates.  This limitation hampers the system's ability to efficiently
   handle and incorporate incremental changes.

4.5.  Multi-party Collaboration

   Mutually Agreed Norms for Routing Security (MANRS) is a community-
   based approach that aims to enhance the robustness and security of
   the global routing infrastructure.  While MANRS promotes multi-party
   collaboration, the actual implementation currently relies on
   individual optimization of respective data.  The monitoring of
   individual execution is facilitated through MANRS OBSERVATORY
   metrics.  However, there are no effective communication mechanisms
   between participating parties.

   Recent measurements [MANRS] indicate that participants tend to have a
   higher likelihood of implementing routing security practices compared
   to non-participants.  However, despite these efforts, a significant
   number of networks still do not fully deploy Route Origin Validation
   (ROV) or fail to propagate illegitimate announcements from their
   customers, as revealed by recent measurements conducted by the recent
   measurement [ROVDep].  This highlights the challenges faced in
   achieving the desired results through multi-party collaboration, as
   problems in the registration of route origin registries persist.

   To further enhance the effectiveness of collaboration, it is
   imperative to develop more robust, intelligent, and automated
   mechanisms.  These mechanisms can streamline communication and
   facilitate seamless collaboration between MANRS participants.

4.6.  Summary

   At present, both the Internet Routing Registry (IRR) and the Resource
   Public Key Infrastructure (RPKI) serve as the primary sources for
   route origin registries.  However, these systems encounter certain
   challenges, such as inadequate announcement coverage and inaccurate
   data.  Consequently, it becomes increasingly challenging to
   differentiate between legitimate Multiple Origin AS (MOAS) and
   instances of route hijacking or misconfiguration.

   To better address these issues, there have been proposals to
   integrate multiple route origin registries simultaneously.  However,
   the lack of effective data validation in current synchronization
   protocols between multiple sources hampers the ability to handle
   inconsistencies that arise from inaccurate data.  In recent years,
   MANRS has played a role in facilitating route origin registries.
   However, it has not been able to achieve the desired results due to
   its reliance solely on the self-initiative of MANRS participants.

5.  Security Considerations

   There is no security consideration in this draft.

6.  IANA Considerations

   There is no IANA consideration in this draft.

7.  References

7.1.  Normative References

   [NRTMv4]   Romijn, S., Snijders, J., Shryane, E., and S.
              Konstantaras, "Near Real Time Mirroring (NRTM) version 4",
              Work in Progress, Internet-Draft, draft-ietf-grow-nrtm-
              v4-03, 26 November 2023,
              <https://datatracker.ietf.org/doc/html/draft-ietf-grow-
              nrtm-v4-03>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC6480]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", RFC 6480, DOI 10.17487/RFC6480,
              February 2012, <https://www.rfc-editor.org/rfc/rfc6480>.

   [RFC6811]  Mohapatra, P., Scudder, J., Ward, D., Bush, R., and R.
              Austein, "BGP Prefix Origin Validation", RFC 6811,
              DOI 10.17487/RFC6811, January 2013,
              <https://www.rfc-editor.org/rfc/rfc6811>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8182]  Bruijnzeels, T., Muravskiy, O., Weber, B., and R. Austein,
              "The RPKI Repository Delta Protocol (RRDP)", RFC 8182,
              DOI 10.17487/RFC8182, July 2017,
              <https://www.rfc-editor.org/rfc/rfc8182>.

   [RFC8416]  Ma, D., Mandelberg, D., and T. Bruijnzeels, "Simplified
              Local Internet Number Resource Management with the RPKI
              (SLURM)", RFC 8416, DOI 10.17487/RFC8416, August 2018,
              <https://www.rfc-editor.org/rfc/rfc8416>.

7.2.  Informative References

   [CAIDA]    "RouteViews Prefix to AS mappings", 2024,
              <https://catalog.caida.org/dataset/routeviews_prefix2as>.

   [IRRedicator]
              Kang, M., Li, W., van Rijswijk-Deij, R., TT Kwon, and T.
              Chung, "IRRedicator: Pruning IRR with RPKI-Valid BGP
              Insights", Network and Distributed System Security (NDSS)
              Symposium 2024 , 2024.

   [IRRegularities]
              Du, B., Izhikevich, K., Rao, S., Akiwate, G., Testart, C.,
              AC Snoeren, and K. Claffy, "IRRegularities in the internet
              routing registry", Proceedings of the 2023 ACM on internet
              measurement conference , 2023.

   [MANRS]    Du, B., Testart, C., Fontugne, R., Akiwate, G., AC
              Snoeren, and K. Claffy, "Mind your MANRS: measuring the
              MANRS ecosystem", Proceedings of the 22nd ACM Internet
              Measurement Conference , 2022.

   [RFC1930]  Hawkinson, J. and T. Bates, "Guidelines for creation,
              selection, and registration of an Autonomous System (AS)",
              BCP 6, RFC 1930, DOI 10.17487/RFC1930, March 1996,
              <https://www.rfc-editor.org/rfc/rfc1930>.

   [RFC4272]  Murphy, S., "BGP Security Vulnerabilities Analysis",
              RFC 4272, DOI 10.17487/RFC4272, January 2006,
              <https://www.rfc-editor.org/rfc/rfc4272>.

   [RFC7682]  McPherson, D., Amante, S., Osterweil, E., Blunk, L., and
              D. Mitchell, "Considerations for Internet Routing
              Registries (IRRs) and Routing Policy Configuration",
              RFC 7682, DOI 10.17487/RFC7682, December 2015,
              <https://www.rfc-editor.org/rfc/rfc7682>.

   [RFC9319]  Gilad, Y., Goldberg, S., Sriram, K., Snijders, J., and B.
              Maddison, "The Use of maxLength in the Resource Public Key
              Infrastructure (RPKI)", BCP 185, RFC 9319,
              DOI 10.17487/RFC9319, October 2022,
              <https://www.rfc-editor.org/rfc/rfc9319>.

   [ROVDep]   Qin, L., Chen, L., Li, D., Ye, H., and Y. Wang,
              "Understanding Route Origin Validation (ROV) Deployment in
              the Real World and Why MANRS Action 1 Is Not Followed",
              Network and Distributed System Security (NDSS) Symposium
              2024 , 2024.

   [RoVista]  Li, W., Lin, Z., MI Ashiq, Aben, E., Fontugne, R.,
              Phokeer, A., and T. Chung, "RoVista: Measuring and
              analyzing the route origin validation (ROV) in RPKI",
              Proceedings of the 2023 ACM on Internet Measurement
              Conference , 2023.

Acknowledgments

   TODO acknowledge.

Author's Address

   Shenglin Jiang
   Zhongguancun Laboratory
   Email: jiangshl@zgclab.edu.cn
