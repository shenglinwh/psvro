



SIDROPS                                                         S. Jiang
Internet-Draft                                   Zhongguancun Laboratory
Intended status: Informational                             16 March 2024
Expires: 17 September 2024


Problem Statement and Requirements for Enhancing Route Origin Validation
                     Using Multi-Source Information
                    draft-jiang-sidrops-psvro-latest

Abstract

   Prefix hijacking has emerged as a major security threat in the Border
   Gateway Protocol (BGP), garnering widespread attention.  To mitigate
   such attacks, Internet Routing Registries (IRR) and Resource Public
   Key Infrastructure (RPKI) have been developed, providing reliable
   mappings of IP prefixes to authorized Autonomous Systems (ASes).
   Nonetheless, challenges persist due to outdated Route objects within
   IRR and the limited deployment rates of RPKI.  Recently, several
   organizations have adopted the approach of integrating IRR, RPKI, and
   local data to enhance the quality of route origin.  This document
   describes problem statement and requirements for enhancing route
   origin validation using multi-source information.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 17 September 2024.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Requirements Language
   2.  Problem Statement
     2.1.  Integrity and Accuracy of Route Origin
     2.2.  Lack of Support for MOAS
     2.3.  Inconsistency Among Multiple Sources
   3.  Requirements
     3.1.  Verifiability of Route Origin Data
     3.2.  Fusion of Multiple Sources of Information
     3.3.  Automated Updates
     3.4.  Multi-Party Collaboration Mechanism
   4.  Security Considerations
   5.  IANA Considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   Acknowledgments
   Author's Address

1.  Introduction

   The Border Gateway Protocol (BGP) is widely used for inter-domain
   route.  However, due to the lack of built-in routing security
   mechanisms, BGP is vulnerable to various security threats such as
   prefix hijacking.  To mitigate such attacks, the global Internet
   infrastructure needs to create a database to record the mapping of IP
   prefixes to authorized origin ASes, which can be used to determine
   whether BGP announcements are propagated or discarded.

   Currently, network operators primarily rely on Internet Routing
   Registry (IRR) and Resource Public Key Infrastructure (RPKI)[RFC6480]
   as route origin sources.  However, IRR suffers from a lack of
   effective validation mechanisms and incentives for resource holders
   to update objects, leading to the prevalence of outdated objects.  On
   the other hand, RPKI faces challenges in terms of complex operations,
   misissued ROA, and the certificate dependencies in the hierarchy of
   RPKI, which hinder its widespread deployment.

   To fully leverage existing sources and improve the accuracy of route
   validation, enhance the robustness and security of the global routing
   system.  Many suggestions and solutions have been proposed, for
   example:

   *  Mutually Agreed Norms for Routing Security (MANRS) have
      recommended the use of both IRR and RPKI.

   *  JPIRR removing IRR Route objects that have not been updated within
      a given timeframe.

   *  RIPE NCC and IRRdv4 utilize RPKI (Resource Public Key
      Infrastructure) to validate and filter IRR Route objects.

   *  [IRRedicator] leverages machine learning algorithms to identify
      stale Route objects, aiming to enhance the consistency between IRR
      and RPKI.

   *  SLURM[RFC8416] allow ISPs to establish a local RPKI view by
      enabling local filtering and additions based on specific
      requirements.

   This document aims to provide insights and recommendations to network
   operators, researchers, and policymakers for improving the security
   and robustness of the global routing system by analyzing the problems
   associated with route origin validation, particularly the integration
   of multi-source information.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.  Problem Statement

2.1.  Integrity and Accuracy of Route Origin

   As more ISPs participate in route origin databases, the coverage of
   address space by these databases has gradually increased.  As of
   February 2024, the RADB database has the highest IPv4 address space
   coverage, reaching up to 42%. In contrast, the NESTEGG database only
   has four Route object data.  However, the IPv4 address space coverage
   of RPKI is only 35%. Therefore, relying solely on a single IRR or
   RPKI database for route filtering and validation is insufficient due
   to the limited address space coverage.

   There are significant differences in the update activity of Route
   objects among active IRR databases.  Some databases maintain a high
   level of update activity, with recent updates occurring within the
   past year, such as LACNIC, JPIRR, and RADB.  On the other hand, there
   are databases whose Route objects have not been updated in the past
   five years, such as WCGDB, NESTEGG, PANIX, and REACH.  The other
   databases also contain a larger percentage of Route objects that have
   not been updated in the short term.  This state leads to a large
   amount of outdated and stale Route objects, which affects the
   reliability of the data sources.

   According to measurements from [IRRegularities], Route objects from
   JPIRR, RIPE, ARIN, ALTDB, and LACNIC have overlap rates in recent BGP
   announcements exceeding 60%, while databases such as APNIC, NTTCOM,
   WCGDB, PANIX, and ARIN-NA have rates below 20%. This indicates that
   some databases have lower activity and may contain a higher
   proportion of outdated data.  The RADB database, which has the
   highest overlap rate, has 29.8% of its Route objects appearing in BGP
   announcements.

2.2.  Lack of Support for MOAS

   [RFC1930] suggests that a prefix should only have a single AS as its
   origin with a few exceptions.  However, according to routing data
   from Routeviews[CAIDA], MOAS (Multi-origin ASes) has become a common
   phenomenon, which can be due to multi-homing, Internet exchange
   points, and multinational companies, as well as due to
   misconfigurations or prefix hijacking.

   Analyzing the MOAS state, as of 2024, the currently active IRR
   databases can provide full coverage for only 31% of IPv4 MOAS and 4%
   of IPv6 MOAS.  The RPKI database can provide full coverage for 26% of
   IPv4 MOAS and 3.55% of IPv6 MOAS.  Differentiating between legitimate
   MOAS and those caused by misconfigurations or route hijacking poses a
   significant challenge for existing route origin databases.

   Legitimate MOAS is primarily caused by factors such as multinational
   companies and multi-homing.  However, the current authoritative IRR
   and RPKI databases typically only allow registration of address
   blocks managed by the respective RIR.  This poses a significant
   obstacle to support legitimate MOAS.  On the other hand,
   misconfigurations usually occur within the same ISP, i.e., the ISP
   has multiple ASNs and IP prefixes, resulting from confusion during
   the configuration/update Route or ROA objects.  These cases can
   bypass the current validation mechanisms.

2.3.  Inconsistency Among Multiple Sources

   As analyzed in section 2.1, relying on a single source of route
   origin database is insufficient for route origin validation.
   However, the IPv4 address coverage can reach 67% by integrating
   multiple active IRR databases.  Further, the IPv4 address coverage
   can reach 70% with the addition of the RPKI database.  Moreover, the
   number of ASes participating in IRR or RPKI accounted for 86.5% of
   the total number of assigned ASes.

   Leveraging database from multiple sources can effectively improve the
   coverage of routing origin for Internet numbering resources.
   However, according to recent measurement[IRRegularities], there are
   inconsistencies among the Route object across different IRR
   databases, which may be due to chronic neglect on the part of the IRR
   customers.  For instance, the company register Route objects in
   multiple IRR databases, but it updates Route objects in only a subset
   of those IRR databases, while neglecting the others, resulting in
   outdated and stale Route objects.

   We found that in February 2024, the IRR databases maintained by the
   five RIRs, as well as JPIRR, IDNIC, and maintained by Local Internet
   Registries (LIRs), exhibit a higher consistency with RPKI.  On the
   other hand, IRR databases maintained by third parties such as RADB,
   TC, and NTTCOM have lower consistency with RPKI, with ineffective
   RPKI validation.  Other IRR databases show significant differences
   with RPKI, such as PANIX, BELL, REACH, WCGDB, primarily manifested as
   low Route object overlap and high ineffective rate of route
   validation.  Because RPKI contains the validation mechanism and each
   object has validity period, IRR databases that are inconsistent with
   RPKI may contains more stale Route objects.

3.  Requirements

3.1.  Verifiability of Route Origin Data

   Internet registries have attempted to address the issue of outdated
   objects in their IRR databases by implementing filtering rules.  For
   example, JPIRR removes IRR objects that have not been updated within
   a specified period, typically one year.  While simple rule-based
   validation can partially improve quality of current routing origin,
   more innovative mechanisms are required for intentionally malicious
   prefix hijacking.

   There is a requirement for verifiable route origin sources to enhance
   quality of route origin database and instill confidence in network
   operators when validating using route origin.  Additionally, it is
   important to leverage the collective oversight of the Internet
   registries by providing a negative feedback mechanism for theirs
   customers, which filters out relevant outdated and stale data,
   improves current registration and maintenance dependencies on
   resource holders, and further enhances the availability of route
   origin for validation.

3.2.  Fusion of Multiple Sources of Information

   To improve the accuracy of route origin, several organizations
   currently disable IRR Route objects using authoritative RPKI or local
   sources, which contribute to enhancing route origin reliability and
   provide customized services for route validation.

   Route origin should integrate multidimensional and multi-source
   information, such as commercial relationships, geographic
   relationships, and adjacency relationships, which can further assist
   in route origin validation for multi-homing and multinational
   companies, etc.  Additionally, we can utilize maintained data of each
   ISP to improve the quality of route origins through consensus and
   collaboration, since the Internet consists of multiple networks.

3.3.  Automated Updates

   The introduction of incremental update protocols such as
   RRDP[RFC8182] and NRTM[NRTMv4] reduces the interval for data source
   updates.  However, these protocols only synchronize data without
   performing validation, even if there may be differences with their
   own data.  To address revocation and update issues caused by the
   granularity of RPKI management, current solutions such as Minimal-
   ROA[RFC9319] have been proposed.

   During fusion of multiple sources, route origin can performed
   preliminary verification while promoting automated incremental
   updates, which ensures consistency of global route origin and
   automatically raises concerns about discrepant data.  We can advance
   data accuracy and consistency, through multi-party consensus and
   negotiation for discrepant data.  Additionally, to ensure flexibility
   in data updates and revocations, we should accelerate development of
   innovative route origin management, ensuring efficient and timely
   updates based on state changes.

3.4.  Multi-Party Collaboration Mechanism

   MANRS make the global routing infrastructure more robust and secure
   by community-based approach.  While MANRS proposes and advocates for
   multi-party collaboration, the actual implementation still relies on
   individual optimization of respective data, with monitoring of
   individual execution using the MANRS OBSERVATORY metrics, but lacks
   effective communication and collaboration mechanisms between parties.

   To ensure the reliability of route origin, we should introduce
   automated multi-party collaboration mechanism, which maintains multi-
   party consensus and a globally consistent view of route origin
   validation, serving as the basis for relevant route origin
   validation.  Additionally, this collaboration mechanism should fully
   consider the deployment benefits during partial or incremental
   deployment stages, attracting more participants to join the automated
   multi-party collaboration framework.

4.  Security Considerations

   There is no security consideration in this draft.

5.  IANA Considerations

   There is no IANA consideration in this draft.

6.  References

6.1.  Normative References

   [NRTMv4]   Romijn, S., Snijders, J., Shryane, E., and S.
              Konstantaras, "Near Real Time Mirroring (NRTM) version 4",
              Work in Progress, Internet-Draft, draft-ietf-grow-nrtm-
              v4-03, 26 November 2023,
              <https://datatracker.ietf.org/doc/html/draft-ietf-grow-
              nrtm-v4-03>.

   [RFC1930]  Hawkinson, J. and T. Bates, "Guidelines for creation,
              selection, and registration of an Autonomous System (AS)",
              BCP 6, RFC 1930, DOI 10.17487/RFC1930, March 1996,
              <https://www.rfc-editor.org/rfc/rfc1930>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC6480]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", RFC 6480, DOI 10.17487/RFC6480,
              February 2012, <https://www.rfc-editor.org/rfc/rfc6480>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8182]  Bruijnzeels, T., Muravskiy, O., Weber, B., and R. Austein,
              "The RPKI Repository Delta Protocol (RRDP)", RFC 8182,
              DOI 10.17487/RFC8182, July 2017,
              <https://www.rfc-editor.org/rfc/rfc8182>.

   [RFC8416]  Ma, D., Mandelberg, D., and T. Bruijnzeels, "Simplified
              Local Internet Number Resource Management with the RPKI
              (SLURM)", RFC 8416, DOI 10.17487/RFC8416, August 2018,
              <https://www.rfc-editor.org/rfc/rfc8416>.

   [RFC9319]  Gilad, Y., Goldberg, S., Sriram, K., Snijders, J., and B.
              Maddison, "The Use of maxLength in the Resource Public Key
              Infrastructure (RPKI)", BCP 185, RFC 9319,
              DOI 10.17487/RFC9319, October 2022,
              <https://www.rfc-editor.org/rfc/rfc9319>.

6.2.  Informative References

   [CAIDA]    "RouteViews Prefix to AS mappings", 2024,
              <https://catalog.caida.org/dataset/routeviews_prefix2as>.

   [IRRedicator]
              Kang, M., Li, W., van Rijswijk-Deij, R., TT Kwon, and T.
              Chung, "IRRedicator: Pruning IRR with RPKI-Valid BGP
              Insights", Network and Distributed System Security (NDSS)
              Symposium 2024 , 2024.

   [IRRegularities]
              Du, B., Izhikevich, K., Rao, S., Akiwate, G., Testart, C.,
              AC Snoeren, and kc claffy, "IRRegularities in the internet
              routing registry", Proceedings of the 2023 ACM on internet
              measurement conference , 2023.

Acknowledgments

   TODO acknowledge.

Author's Address

   Shenglin Jiang
   Zhongguancun Laboratory
   Email: jiangshl@zgclab.edu.cn
