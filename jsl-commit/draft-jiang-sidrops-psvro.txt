



SIDROPS                                                         S. Jiang
Internet-Draft                                   Zhongguancun Laboratory
Intended status: Informational                             25 April 2024
Expires: 27 October 2024


                Route Origin Registry Problem Statement
                    draft-jiang-sidrops-psvro-latest

Abstract

   Prefix hijacking has emerged as a major security threat in the Border
   Gateway Protocol (BGP), garnering widespread attention.  To mitigate
   such attacks, Internet Routing Registries (IRR) and Resource Public
   Key Infrastructure (RPKI) have been developed, providing reliable
   mappings of IP prefixes to authorized Autonomous Systems (ASes).
   Nonetheless, challenges persist due to accuracy and integrity of
   route origin contained within the IRR and the RPKI.  This document
   serves to outline the current state and problem statement for route
   origin registry.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 27 October 2024.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Requirements Language
   3.  Working Definition of Route Origin Registry
   4.  Problem Statement
     4.1.  Multi-origin ASes Analysis
     4.2.  Accuracy of Route Origin Registry
     4.3.  Route Origin Registry Coverage
     4.4.  Inconsistency of Multi-source Data
     4.5.  Management and Synchronization
     4.6.  Summary
   5.  Security Considerations
   6.  IANA Considerations
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Acknowledgments
   Author's Address

1.  Introduction

   The Border Gateway Protocol (BGP) is ubiquitously used for inter-
   domain routing.  However, it lacks built-in security validation that
   updates are legitimate [RFC4272].  To mitigate security concerns
   related to prefix hijacking resulting from the absence of security
   mechanisms, the Internet Routing Registry (IRR) [RFC1786] and
   Resource Public Key Infrastructure (RPKI) [RFC6480] were developed
   and implemented.  These mechanisms serve the purpose of documenting
   the mapping relationship between IP prefixes and their respective
   origin Autonomous Systems (ASes).

   However, IRR lacks standard validation mechanisms and fails to
   incentivize resource holders to update objects, resulting in outdated
   and stale information.  Similarly, RPKI faces challenges related to
   complex operations and the hierarchical dependencies of certificates,
   limiting its widespread deployment.  To effectively combat malicious
   traffic and strengthen the resilience of the global routing
   infrastructure, it is crucial to establish a comprehensive route
   origin registry system that offers extensive coverage, high accuracy,
   and verifiability.

   This document aims to provide insights and recommendations to network
   operators, researchers, and policymakers for improving the security
   and robustness of the global routing system.

2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Working Definition of Route Origin Registry

   Route origin registry refers to a repository that records the mapping
   of IP prefixes to the ASes authorised to announce them.  Resource
   holders can register route origin mapping relationships in route
   origin registry by themselves or delegate to others.

   The IRR and RPKI systems currently offer functionalities related to
   route origin registry.  The IRR, which has been in operation since
   1995, serves as a globally distributed database for routing
   information.  It records the binding relationship between IPs and
   Autonomous System Numbers (ASes) via Route(6) objects, which are
   defined by the Routing Policy Specification Language (RPSL).

   On the other hand, the RPKI system, which was developed starting in
   2008 and began its deployment in 2011, provides a formally verifiable
   framework.  The RPKI system is based on resource certificates that
   extend the X.509 standard.  It records the mapping between IP
   prefixes and their authorised ASes via Route Origin Authorization
   (ROA) objects.  These ROA objects contain essential information such
   as the prefix, origin (ASN), and MaxLength.

4.  Problem Statement

4.1.  Multi-origin ASes Analysis

   [RFC1930] suggests that a prefix should typically have a single
   Autonomous System (AS) as its origin, with a few exceptions.
   However, analysis of routing data from Routeviews, conducted by CAIDA
   [CAIDA], reveals that Multi-origin ASes (MOAS) have become a common
   phenomenon.  There are various reasons that contribute to the
   emergence of MOAS events:

   *  *_Multi-homing_*: An organization is connected to multiple
      networks without the use of BGP to manage the routing.

   *  *_Aggregation_*: When using the AS_SET attribute in BGP to
      aggregate routes, a prefix can be depicted as residing in multiple
      AS.

   *  *_Business relationship_*: Companies often choose specialized
      providers that offer high-speed and reliable data services to host
      their servers.  Additionally, a parent organization that owns a
      large chunk of IP addresses may divide its address space among one
      or more child organizations for efficient resource allocation.

   *  *_Multi-National Companies_*: A multi-national company may
      advertise its prefix from countries where it has offices.

   *  *_Traffic engineering_*: An organization may advertise
      reachability to its prefixes from multiple ASs it owns.

   *  *_Internet Exchanges_*: A prefix associated with an exchange point
      can be directly reachable from all the ASes at the exchange point.

   *  *_Anycasting_*: An anycast prefix is intended to originate from
      multiple ASes.

   *  *_Misconfigurations_*: Unwanted incoming traffic can occur due to
      misconfiguration.

   *  *_Prefix Hijacking_*: Malicious AS may advertise prefixes
      belonging to another organization, with the intention of
      intercepting its traffic.

   Since legitimate MOAS, and prefix hijacking/misconfiguration, etc.,
   have similar behaviour, it has been a challenge to distinguish
   between them, and it also imposes higher requirements on the coverage
   and accuracy of route origin registry.

4.2.  Accuracy of Route Origin Registry

   As mentioned in [RFC7682], the lack of certification and incentives
   for maintaining up-to-date data within Internet Routing Registry
   (IRR) leads to lower accuracy of the information.  While a few IRRs
   exhibit regular updates, others have low activity with many Route(6)
   objects remaining unchanged for several years.  Recent measurement
   [IRRegularities] reveals that IRRs with low update activity exhibit
   lower overlap with BGP announcements compared to those with high
   update activity.  This indicates that IRRs with lower activity may
   contain a higher proportion of outdated and stale Route objects,
   thereby impacting the reliability of the route origin registry.

   The Resource Public Key Infrastructure (RPKI) utilizes CA
   certificates to authorize resources from higher tiers to lower tiers.
   However, there is a risk of conflicts in resource ownership when
   misconfiguration or malicious operations occur at the upper tier,
   resulting in multiple lower tiers being allocated the same resource.
   Additionally, the existence of legitimate MOAS necessitates the
   allocation of duplicate resources, further complicating the issue.
   Balancing the protection of legitimate MOAS while minimizing
   conflicts in resource allocation presents a challenging problem that
   requires innovative solutions.  Furthermore, it is worth noting that
   the RPKI Relying Parties [RFC8897] has not yet standardized the
   process of constructing certificate chains, handling exceptions such
   as Certificate Revocation Lists (CRLs) and Manifests.  This lack of
   the standardized document has resulted in different RPKI views among
   Relying Parties (RPs) who adopt different implementations.
   Consequently, this can lead to varying validation results for the
   same route announcement by AS within the service scope of different
   RPs.

   Consequently, the absence of data validation and standardization in
   operations within the IRR or RPKI framework means that there is no
   guarantee of the accuracy of the data registered at the route origin
   registry.

4.3.  Route Origin Registry Coverage

   As the adoption of Resource Public Key Infrastructure (RPKI)
   continues to grow, the number of address prefixes registered within
   RPKI is gradually increasing.  However, according to recent report
   [NRO], its coverage of IP prefixs has been relatively low.  Notably,
   the protection rate of route origin validation(ROV), as measured by
   Mutually Agreed Norms for Routing Security (MANRS) [MANRS], is
   significantly lower compared to route origin authorization(ROA)
   coverage.  Additionally, [IRRegularities] also notes a decreasing
   trend in IP Prefix coverage in certain IRRs.

   When examining the MOAS state, it becomes evident that currently
   active IRRs and RPKI offer limited full coverage for MOAS,
   particularly in the case of IPv6 MOAS.  Moreover, the existing
   authoritative IRR (maintained by regional Internet registries) and
   RPKI typically only allow registration of address blocks for self-
   managed purposes.  This poses a significant obstacle in supporting
   legitimate MOAS.

   Limited IP prefix coverage within the current route origin registry,
   especially for MOAS events, does not allow for adequate BGP
   announcement validation, much less distinguishing legitimate MOAS
   from prefix hijacking or misconfiguration.

4.4.  Inconsistency of Multi-source Data

   Based on the analysis presented in the previous section, it is
   evident that relying solely on a single source of route origin
   registry is insufficient in route origin validation.  To address this
   issue effectively, it is recommended to integrate the RPKI and
   multiple active IRRs.  This integration would not only enhance the IP
   address space coverage and AS participation rate but also improve the
   accuracy of route origin registry.

   However, it is important to note that this fusion approach may
   encounter several limitations.  As highlighted in [IRRegularities],
   inconsistencies exist among the Route(6) objects across different
   IRRs.  This inconsistency can be attributed to the chronic neglect of
   IRR customers.  For instance, some companies may register Route
   objects in some IRRs but fail to update them in all the route origin
   registries, resulting in outdated and stale Route(6) objects.
   Furthermore, it is observed that a higher number of IRRs exhibit
   lower consistency with RPKI.  In practice, different networks often
   use different data and methodologies to perform route validation and
   filtering, resulting in disparate outcome, especially when ROA and
   IRR data conflict with each other.

   As a result, while integrating the RPKI and multiple active IRRs can
   improve the effectiveness of route origin validation, it is essential
   to address the issues of inconsistencies and outdated Route objects
   within the IRRs.

4.5.  Management and Synchronization

   The current practice in IRRs involves the use of the Near-Real-Time
   Mirroring (NRTM) protocol [NRTMv4] to replicate and synchronize Route
   object from other IRRs.  Similarly, RPKIs rely on the RPKI Repository
   Delta Protocol (RRDP) [RFC8182] to synchronize and update data.
   However, these network protocols exhibit several weaknesses that need
   to be addressed.

   *  The lack of validation of replicated data from mirrored sources in
      both IRRs and RPKIs is a significant concern.  This leaves room
      for potential inconsistencies and conflicts with the existing
      data, compromising the integrity of the route origin registry.

   *  The absence of application security mechanisms within these
      protocols is another area of vulnerability.  This lack of security
      measures exposes the system to potential threats and unauthorized
      access.

   *  The absence of a mechanism to notify other mirrors when updates
      occur results in synchronization delays and data inconsistency
      issues.  This can be problematic when timeliness and accuracy are
      crucial.

   On the other hand, to address revocation and update issues by coarse-
   grained management, alternative solutions such as Minimal-ROA
   [RFC9319] have been proposed.  While Minimal-ROA enhances coding
   efficiency and scalability by minimizing the use of the maxLength
   parameter, it falls short in supporting efficient incremental
   updates.  This limitation hampers the system's ability to efficiently
   handle and incorporate incremental changes.

4.6.  Summary

   Currently, the Internet Routing Registry (IRR) and the Resource
   Public Key Infrastructure (RPKI) are the main sources for route
   origin registries.  As the Internet evolves, the occurrence of
   Multiple Origin Autonomous System (MOAS) situations becomes more
   prevalent, which places higher demands on the route origin registry
   system.  However, these systems face challenges such as incomplete
   announcement coverage and inaccurate data.

   To tackle these challenges, proposals have been made to integrate
   multiple route origin registries simultaneously.  However, the
   existing synchronization protocols between these sources lack
   effective data validation, which impedes the ability to handle
   inconsistencies resulting from inaccurate data.

   Efforts are required to enhance the accuracy and reliability of route
   origin registries by addressing the limitations of current
   synchronization protocols.  By doing so, we can improve the
   effectiveness of these registries in dealing with MOAS scenarios and
   ensure a more robust route origin registry system.

5.  Security Considerations

   There is no security consideration in this draft.

6.  IANA Considerations

   There is no IANA consideration in this draft.

7.  References

7.1.  Normative References

   [RFC1786]  Bates, T., Gerich, E., Joncheray, L., Jouanigot, J.,
              Karrenberg, D., Terpstra, M., and J. Yu, "Representation
              of IP Routing Policies in a Routing Registry (ripe-81++)",
              RFC 1786, DOI 10.17487/RFC1786, March 1995,
              <https://www.rfc-editor.org/rfc/rfc1786>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC6480]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", RFC 6480, DOI 10.17487/RFC6480,
              February 2012, <https://www.rfc-editor.org/rfc/rfc6480>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8182]  Bruijnzeels, T., Muravskiy, O., Weber, B., and R. Austein,
              "The RPKI Repository Delta Protocol (RRDP)", RFC 8182,
              DOI 10.17487/RFC8182, July 2017,
              <https://www.rfc-editor.org/rfc/rfc8182>.

7.2.  Informative References

   [CAIDA]    "RouteViews Prefix to AS mappings", 2024,
              <https://catalog.caida.org/dataset/routeviews_prefix2as>.

   [IRRedicator]
              Kang, M., Li, W., van Rijswijk-Deij, R., TT Kwon, and T.
              Chung, "IRRedicator: Pruning IRR with RPKI-Valid BGP
              Insights", Network and Distributed System Security (NDSS)
              Symposium 2024 , 2024.

   [IRRegularities]
              Du, B., Izhikevich, K., Rao, S., Akiwate, G., Testart, C.,
              AC Snoeren, and K. Claffy, "IRRegularities in the internet
              routing registry", Proceedings of the 2023 ACM on internet
              measurement conference , 2023.

   [MANRS]    "MANRS Observatory", 2024,
              <https://observatory.manrs.org/>.

   [NRO]      "RIR Statistics", 2024,
              <https://www.nro.net/about/rirs/statistics/>.

   [NRTMv4]   Romijn, S., Snijders, J., Shryane, E., and S.
              Konstantaras, "Near Real Time Mirroring (NRTM) version 4",
              Work in Progress, Internet-Draft, draft-ietf-grow-nrtm-
              v4-03, 26 November 2023,
              <https://datatracker.ietf.org/doc/html/draft-ietf-grow-
              nrtm-v4-03>.

   [RFC1930]  Hawkinson, J. and T. Bates, "Guidelines for creation,
              selection, and registration of an Autonomous System (AS)",
              BCP 6, RFC 1930, DOI 10.17487/RFC1930, March 1996,
              <https://www.rfc-editor.org/rfc/rfc1930>.

   [RFC4272]  Murphy, S., "BGP Security Vulnerabilities Analysis",
              RFC 4272, DOI 10.17487/RFC4272, January 2006,
              <https://www.rfc-editor.org/rfc/rfc4272>.

   [RFC7682]  McPherson, D., Amante, S., Osterweil, E., Blunk, L., and
              D. Mitchell, "Considerations for Internet Routing
              Registries (IRRs) and Routing Policy Configuration",
              RFC 7682, DOI 10.17487/RFC7682, December 2015,
              <https://www.rfc-editor.org/rfc/rfc7682>.

   [RFC8897]  Ma, D. and S. Kent, "Requirements for Resource Public Key
              Infrastructure (RPKI) Relying Parties", RFC 8897,
              DOI 10.17487/RFC8897, September 2020,
              <https://www.rfc-editor.org/rfc/rfc8897>.

   [RFC9319]  Gilad, Y., Goldberg, S., Sriram, K., Snijders, J., and B.
              Maddison, "The Use of maxLength in the Resource Public Key
              Infrastructure (RPKI)", BCP 185, RFC 9319,
              DOI 10.17487/RFC9319, October 2022,
              <https://www.rfc-editor.org/rfc/rfc9319>.

Acknowledgments

   TODO acknowledge.

Author's Address

   Shenglin Jiang
   Zhongguancun Laboratory
   Email: jiangshl@zgclab.edu.cn
